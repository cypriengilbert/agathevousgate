{% extends 'base.html.twig' %} {% block body %}

<body>
    <div class="container">
    <h1 class="text-center">
    Collection {{ collection.title}}
    </h1>
    <div class="col-sm-2 no_padding">
    {% for collectionList in allCollection %}
    <a  style="position:fixed" href="{{path('addBoutiqueToCart', {'name': collectionList.title })}}">{{ collectionList.title }}</a><br>

    {% endfor %}


    </div>
    <div class="col-sm-7 no_padding">
        {% for color in colors %}
        <div class="row">
        <script>
        function open_div_{{color.id}}(){
          if(document.getElementById('collapse{{color.id}}').className == 'panel-collapse collapse in'){
          document.getElementById('collapse{{color.id}}').className='panel-collapse collapse';
        }
        else{
        document.getElementById('collapse{{color.id}}').className='panel-collapse collapse in';
        }
        }
        </script>
           <div class="col-sm-12 no_padding">
              <div class="panel-group" id="accordion">
                 <div class="panel panel-default" style="margin-top:20px; background-color:white;">
                    <div id="panel-heading-coffret" class="panel-heading panel-heading-plugin" style="background:url({{ asset('/upload/color/thumbnail/' ~ color.imageColorName)}});" onclick="open_div_{{color.id}}();">
                       <div class="row">
                          <div class="col-sm-11">
                             <h3 class="panel-title" >
                             {{color.name_public}}
                             </h3>
                          </div>
                          <div class="col-sm-1 text-right">
                          </div>
                       </div>
                    </div>
                    <div id="collapse{{color.id}}" class="panel-collapse collapse" style="background-color:white;">
                       <div class="panel-body">
                          <div class="row">
                            <div class="col-sm-1">
                            </div>
                          {% for product in products %}
                            <div class="col-sm-2">
                              <div class="row">
                                <div class="col-sm-12 text-center" style="min-height: 50px">
                                {{product.cartname}}
                                </div>
                              </div>
                              <div class="row">
                                <div class="col-sm-12 text-center" style="margin-top:10px" >
                                  <img src="{{ asset('/upload/product/' ~ product.imageProductName)}}" style="max-width:100%;height:30px">
                                </div>
                              </div>
                              <div class="row">
                                <div class="col-sm-12 text-center" style="margin-top:10px">
                                <input style="width:100%" type="number" class="form-control" id="quantity_{{product.id}}_{{color.id}}" name="" value="0" min="0" >                                      </center>

                                </div>
                              </div>
                            </div>

                            {% endfor %}
                            <div class="col-sm-1">
                            </div>
                          </div>
                       </div>
                    </div>

                 </div>
              </div>
           </div>

        </div>
    {% endfor %}
    </div>

    <div class="col-sm-2 no_padding" style=" margin-left:20px">
       <div class=" text-center" style=" background-color:#242258;position:fixed; cursor:pointer" onclick="addtocart()" >
               <p style="color:white;line-height:15px;padding-right:10px; padding-top:5px;padding-left:10px "><span class="glyphicon glyphicon-shopping-cart"></span> Ajouter au panier </p>
       </div>

       <a href="{{ path('generic')}}"><div class=" text-center" style=" background-color:#A94141;position:fixed; cursor:pointer; margin-top:50px" >
               <p style="color:white;line-height:15px;padding-right:10px; padding-top:5px;padding-left:10px "> Voir les produits génériques </p>
       </div>
       </a>
    </div>
    </div>
</body>


<script>
function addtocart(){
var finalCart = [];
  {% for color in colors %}
    {% for product in products %}
        value = document.getElementById('quantity_{{product.id}}_{{color.id}}').value;

        finalCart.push([{{product.id}},{{color.id}},value ]);
    {% endfor %}
  {% endfor %}
  var finalJsonCart = JSON.stringify(finalCart);

  var frm = document.getElementById('finalCartField') || null;
  if(frm) {
   frm.value = finalJsonCart;
}
document.getElementById("buttonValidateCart").click();

}

</script>
<div style="display:none">
<form action="{{path('addBoutiqueToCart', {'name': collection.title} )}}"  method="post" id="redirect-form" name="redirect-form">
  <input type="text" name="finalCart" id="finalCartField" >
  <button type="submit" id="buttonValidateCart">Valider</button>
</form>
</div>

{% endblock %}
